<!-- amazon-label-tool/public/index.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>专业亚马逊标签工具 (Cloudflare版)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        :root{--bg-color:#f7f7f8;--main-content-bg:#ffffff;--text-color:#1a1a1a;--text-secondary-color:#6b6b6b;--border-color:#e0e0e0;--accent-color:#5E5CEE;--accent-color-hover:#4d4ac8;--danger-color:#E5484D;--success-color:#34C759;}
        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%}
        body{font-family:'Inter',sans-serif;background-color:var(--bg-color);color:var(--text-color);display:flex;justify-content:center;align-items:center;padding:2rem;font-size:16px;}
        .app-container{width:100%;max-width:500px;background:var(--main-content-bg);border-radius:12px;border:1px solid var(--border-color);box-shadow:0 8px 32px rgba(0,0,0,0.05);padding:2.5rem;display:flex;flex-direction:column;gap:1.8rem;}
        header{text-align:center;}
        h1{font-size:1.8rem;font-weight:700;letter-spacing:-.04em;}
        header p{font-size:1rem;color:var(--text-secondary-color);margin-top:0.5rem;}
        #upload-form > div {margin-bottom: 1.5rem;}
        .form-group label{font-weight:500;margin-bottom:0.5rem;display:block;}
        input[type="text"],input[type="number"]{width:100%;padding:10px 14px;border:1px solid var(--border-color);border-radius:8px;font-size:1rem;transition: all .2s;}
        input[type="text"]:focus,input[type="number"]:focus{border-color:var(--accent-color);box-shadow:0 0 0 3px rgba(94,92,238,0.1);outline:none;}
        .file-input-wrapper{border:2px dashed var(--border-color);border-radius:8px;padding:2rem;text-align:center;cursor:pointer;transition:all .2s;}
        .file-input-wrapper.dragover{border-color:var(--accent-color);background-color:#f5f4ff;}
        .file-input-wrapper p{color:var(--text-secondary-color);}
        .file-input-wrapper span{color:var(--accent-color);font-weight:500;}
        #file-name{font-size:0.9rem;color:var(--success-color);margin-top:0.5rem;text-align:center;font-weight:500;}
        .checkbox-row{display:flex;align-items:center;gap:0.75rem;padding:0.5rem;border-radius:6px;}
        .checkbox-row input[type="checkbox"]{width:1.2rem;height:1.2rem;accent-color:var(--accent-color);}
        .btn{width:100%;padding:14px;font-size:1rem;font-weight:600;border-radius:8px;border:none;background-color:var(--accent-color);color:white;cursor:pointer;transition:background-color .2s;display:flex;align-items:center;justify-content:center;gap:8px;}
        .btn:hover:not(:disabled){background-color:var(--accent-color-hover);}
        .btn:disabled{background-color:#ccc;cursor:not-allowed;}
        .spinner{width:18px;height:18px;border:2px solid rgba(255,255,255,0.3);border-top-color:#fff;border-radius:50%;animation:spin 1s linear infinite;display:none;}
        @keyframes spin{to{transform:rotate(360deg);}}
        #status-message{text-align:center;font-weight:500;min-height:24px;}
        .status-success{color:var(--success-color);}
        .status-error{color:var(--danger-color);}
    </style>
</head>
<body>
    <div class="app-container">
        <header><h1>专业标签工具</h1><p>高精度移除文字 & 添加产地信息</p></header>
        <form id="upload-form">
            <div class="form-group"><label for="file-input">1. 上传PDF文件</label><div class="file-input-wrapper" id="file-dropzone"><p>拖拽文件至此, 或<span>点击选择</span></p></div><input type="file" id="file-input" accept="application/pdf" hidden><div id="file-name"></div></div>
            <div class="form-group"><label for="text-to-remove">2. 移除文字 (可选)</label><input type="text" id="text-to-remove" placeholder="输入公司名、地址等"></div>
            <div class="form-group"><label>3. 添加产地 (可选)</label><div class="checkbox-row"><input type="checkbox" id="add-text-checkbox"><label for="add-text-checkbox">在每个标签底部添加 "Made in China"</label></div><div id="add-text-options" style="display: none; margin-top: 1rem;"><label for="font-size">字体大小 (pt)</label><input type="number" id="font-size" value="8" min="1" style="max-width: 100px;"></div></div>
            <button type="submit" class="btn" id="submit-btn"><span class="spinner" id="spinner"></span><span>处理并下载</span></button>
            <div id="status-message" style="margin-top: 1rem;"></div>
        </form>
    </div>
    <script>
        const API_URL = "/api/process";
        const form = document.getElementById('upload-form'), fileInput = document.getElementById('file-input'), fileDropzone = document.getElementById('file-dropzone'), fileNameDisplay = document.getElementById('file-name'), textToRemoveInput = document.getElementById('text-to-remove'), addTextCheckbox = document.getElementById('add-text-checkbox'), addTextOptions = document.getElementById('add-text-options'), fontSizeInput = document.getElementById('font-size'), submitBtn = document.getElementById('submit-btn'), spinner = document.getElementById('spinner'), statusMessage = document.getElementById('status-message');
        let selectedFile = null;
        fileDropzone.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', () => handleFileSelect(fileInput.files));
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => { fileDropzone.addEventListener(eventName, preventDefaults, false); fileDropzone.addEventListener(eventName, () => fileDropzone.classList.toggle('dragover', ['dragenter', 'dragover'].includes(eventName))); });
        fileDropzone.addEventListener('drop', (e) => handleFileSelect(e.dataTransfer.files), false);
        function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }
        function handleFileSelect(files) { if (files.length > 0) { selectedFile = files[0]; fileNameDisplay.textContent = `已选择: ${selectedFile.name}`; statusMessage.textContent = ''; } }
        addTextCheckbox.addEventListener('change', () => { addTextOptions.style.display = addTextCheckbox.checked ? 'block' : 'none'; });
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!selectedFile) { showStatus('请先选择一个PDF文件', 'error'); return; }
            setLoading(true);
            const formData = new FormData();
            formData.append('file', selectedFile); formData.append('textToRemove', textToRemoveInput.value); formData.append('addMadeInChina', addTextCheckbox.checked); formData.append('fontSize', fontSizeInput.value);
            try {
                const response = await fetch(API_URL, { method: 'POST', body: formData });
                if (!response.ok) { const errorData = await response.json().catch(() => ({error: `服务器错误: ${response.statusText}`})); throw new Error(errorData.error); }
                const blob = await response.blob(); const url = window.URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = `processed-${selectedFile.name}`; document.body.appendChild(a); a.click(); a.remove(); window.URL.revokeObjectURL(url);
                showStatus('处理成功，已开始下载！', 'success');
            } catch (error) { console.error('Error:', error); showStatus(`处理失败: ${error.message}`, 'error'); } finally { setLoading(false); }
        });
        function setLoading(isLoading) { submitBtn.disabled = isLoading; spinner.style.display = isLoading ? 'block' : 'none'; statusMessage.textContent = isLoading ? '正在处理中，请稍候...' : ''; statusMessage.className = ''; }
        function showStatus(message, type) { statusMessage.textContent = message; statusMessage.className = type === 'success' ? 'status-success' : 'status-error'; }
    </script>
</body>
</html>